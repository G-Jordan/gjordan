/* ====== Shared site colors ====== */
:root{
  --app-primary: var(--mainThemeColor, var(--theme-primary, var(--primary-color, #5fa0ff)));
  --app-accent:  var(--accentColor,    var(--theme-accent,  var(--secondary-color, #b478ff)));
}

/* ====== CONTROLS FRAME (unchanged for parity) ====== */
.g73-controls-frame{
  position: relative;
  display: inline-flex;
  border-radius: 18px;
  padding: 8px;
  backdrop-filter: blur(10px);
  background:
    linear-gradient(180deg,
      color-mix(in srgb, var(--ctl-bg, rgba(13,17,23,.72)) 78%, transparent),
      color-mix(in srgb, var(--ctl-bg, rgba(13,17,23,.72)) 52%, transparent));
  outline: 1px solid color-mix(in srgb, var(--ctl-border, rgba(255,255,255,.12)) 65%, transparent);
  box-shadow: 0 14px 36px rgba(0,0,0,.50);
}
.g73-controls-frame::before{
  content:""; position:absolute; inset:0; border-radius:18px; padding:1px;
  background: var(--prog-fill, linear-gradient(90deg,#5fa0ff,#b478ff));
  -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  -webkit-mask-composite: xor; mask-composite: exclude; pointer-events:none;
}
.g73-controls-frame::after{
  content:""; position:absolute; inset:-12px; border-radius:22px;
  background: radial-gradient(60% 60% at 50% 0%,
              color-mix(in srgb, var(--ctl-ring, rgba(120,200,255,.45)) 45%, transparent) 0%,
              transparent 70%);
  filter: blur(18px); opacity:.45; pointer-events:none;
  animation: g73GlowFrame 6s ease-in-out infinite;
}
@keyframes g73GlowFrame{
  0%,100%{ transform: translateY(0) scale(0.98); opacity:.38; }
  50%    { transform: translateY(2px) scale(1.02); opacity:.55; }
}
.controls[data-ctl-theme] .play-pause{
  width:54px !important; height:54px !important; aspect-ratio:1/1; border-radius:50% !important;
}
.controls[data-ctl-theme] .play-pause::before{
  width:43px !important; height:43px !important; aspect-ratio:1/1; border-radius:50% !important;
  left:0; right:0; top:0; bottom:0; margin:auto;
}

/* ====== MUSIC LIST (theme-driven) ====== */
.music-list .g73-list-frame{
  position: relative;
  border-radius: 18px;
  backdrop-filter: blur(10px);
  background:
    linear-gradient(180deg,
      color-mix(in srgb, var(--ctl-list-bg, var(--ctl-bg, rgba(13,17,23,.72))) 78%, transparent),
      color-mix(in srgb, var(--ctl-list-bg, var(--ctl-bg, rgba(13,17,23,.72))) 52%, transparent));
  box-shadow: 0 14px 36px rgba(0,0,0,.50);
  outline: 1px solid color-mix(in srgb, var(--ctl-list-border, var(--ctl-border, rgba(255,255,255,.12))) 65%, transparent);
  overflow: hidden;
}
.music-list .g73-list-frame > ul.g73-adapted{
  margin: 0; padding: 12px;
  max-height: var(--list-max-h, min(56vh, 520px));
  overflow: auto; overscroll-behavior: contain; -webkit-overflow-scrolling: touch;
  background: transparent; border-radius: 18px;
  scrollbar-gutter: stable both-edges;
}
/* Scrollbar */
.music-list .g73-list-frame > ul.g73-adapted::-webkit-scrollbar{ width:10px; height:10px; }
.music-list .g73-list-frame > ul.g73-adapted::-webkit-scrollbar-thumb{
  background: color-mix(in srgb, var(--ctl-list-border, rgba(255,255,255,.12)) 80%, transparent);
  border-radius: 8px;
}
/* Frame ring & glow */
.music-list .g73-list-frame::before{
  content:""; position:absolute; inset:0; border-radius:18px; padding:1px;
  background: var(--ctl-list-fill, var(--prog-fill, linear-gradient(90deg,#5fa0ff,#b478ff)));
  -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  -webkit-mask-composite: xor; mask-composite: exclude; pointer-events:none;
}
.music-list .g73-list-frame::after{
  content:""; position:absolute; inset:-12px; border-radius:22px;
  --_ring: var(--ctl-list-ring-raw, color-mix(in srgb, var(--ctl-list-accent1, #5fa0ff) 55%, transparent));
  background: radial-gradient(60% 60% at 50% 0%, var(--_ring) 0%, transparent 70%);
  filter: blur(18px); opacity:.45; pointer-events:none;
  animation: g73GlowList 6s ease-in-out infinite;
}
@keyframes g73GlowList{
  0%,100%{ transform: translateY(0) scale(0.98); opacity:.38; }
  50%    { transform: translateY(2px) scale(1.02); opacity:.55; }
}
/* Disable old UL-level effects */
.music-list ul.g73-adapted::before,
.music-list ul.g73-adapted::after{ content:none !important; }

/* ====== ROWS ====== */
.music-list ul.g73-adapted > li{
  display:flex; align-items:center; gap:12px;
  padding:12px;            /* normal padding; no extra bottom needed now */
  margin:8px 0;
  border-radius:14px; position:relative;
  border:1px solid color-mix(in srgb, var(--ctl-list-border, rgba(255,255,255,.12)) 85%, transparent);
  background:
    linear-gradient(180deg,
      color-mix(in srgb, var(--ctl-list-bg, rgba(13,17,23,.72)) 82%, transparent),
      color-mix(in srgb, var(--ctl-list-bg, rgba(13,17,23,.72)) 64%, transparent));
  color: var(--ctl-list-text, #e8eef7);
  box-shadow: inset 0 0 0 1px color-mix(in srgb, var(--ctl-list-border, rgba(255,255,255,.12)) 35%, transparent);
  transition: transform .14s ease, box-shadow .14s ease, border-color .14s ease, background .14s ease;
  contain: layout; /* keep layout containment only */
  overflow: visible;
  z-index: 0;
  will-change: box-shadow, transform;
}
.music-list ul.g73-adapted > li > *{ position:relative; z-index: 2; }
.music-list ul.g73-adapted > li:hover{
  --_ring: color-mix(in srgb, var(--ctl-list-accent1, #5fa0ff) 45%, transparent);
  transform: translateY(-1px);
  border-color: color-mix(in srgb, var(--_ring) 50%, var(--ctl-list-border, rgba(255,255,255,.12)));
  box-shadow:
    inset 0 0 0 1px color-mix(in srgb, var(--_ring) 30%, var(--ctl-list-border, rgba(255,255,255,.12))),
    0 6px 18px rgba(0,0,0,.35);
}

/* Thumbnail */
.g73-thumb{
  width:46px; height:46px; flex:0 0 46px;
  border-radius:12px;
  background:#0a0e12 center/cover no-repeat;
  border:1px solid color-mix(in srgb, var(--ctl-list-border, rgba(255,255,255,.12)) 70%, rgba(255,255,255,.12));
  box-shadow: inset 0 0 0 1px rgba(255,255,255,.05);
}

/* Text column */
.g73-meta{ min-width:0; flex:1 1 auto; display:grid; gap:2px; }

/* Title marquee */
.g73-title{
  position: relative;
  width:100%;
  white-space:nowrap;
  overflow:hidden;
  text-overflow: clip;
  font-size:14px; font-weight:800; letter-spacing:.01em; color: var(--ctl-list-text, #e8eef7);
  padding-left:2px;
  mask-image: linear-gradient(90deg, #000 0, #000 calc(100% - 18px), transparent 100%);
  -webkit-mask-image: linear-gradient(90deg, #000 0, #000 calc(100% - 18px), transparent 100%);
}
.g73-title .g73-title-text{ display:inline-block; padding-right:48px; }
.music-list ul.g73-adapted > li .g73-title.is-overflow .g73-title-text{
  animation: g73-marquee var(--mq-duration, 12s) linear infinite;
}
@keyframes g73-marquee{
  from{ transform: translateX(0); }
  to  { transform: translateX(calc(-1 * var(--mq-distance, 0px))); }
}
@media (prefers-reduced-motion: reduce){
  .music-list ul.g73-adapted > li .g73-title.is-overflow .g73-title-text{ animation: none !important; }
}

/* Artist */
.g73-artist{
  font-size:12px;
  color: color-mix(in srgb, var(--ctl-list-subtext, #cfe0ff) 70%, #000 0%);
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
}

/* Duration + play button */
.audio-duration{
  font-size:12px; opacity:.95; min-width:58px; text-align:right;
  color: color-mix(in srgb, var(--ctl-list-text, #e8eef7) 75%, #000 0%);
  position: relative;
  display: inline-flex;
  align-items: center;
  gap: 6px;
  min-width: 70px;
  justify-content: flex-end;
}
.audio-duration .g73-time{
  display:inline-block;
  min-width:34px; /* keeps width stable while counting */
  text-align:right;
}

/* Themed mini 3-bar visualizer (inserted by JS) */
.wave.playing-visualizer{
  display:inline-flex;
  align-items:flex-end;
  gap:3px;
  height: 12px;
  line-height: 0;
  pointer-events: none;
}
.wave.playing-visualizer .bar{
  width:3px;
  border-radius: 2px;
  height: 6px;
  background: linear-gradient(180deg,
              var(--ctl-list-accent1, #5fa0ff),
              var(--ctl-list-accent2, #b478ff));
  box-shadow: 0 0 6px color-mix(in srgb, var(--ctl-list-accent1, #5fa0ff) 45%, transparent);
  animation: g73Wave 1.1s ease-in-out infinite;
  transform-origin: bottom;
}
.wave.playing-visualizer .bar:nth-of-type(2){ animation-delay: .15s; }
.wave.playing-visualizer .bar:nth-of-type(3){ animation-delay: .30s; }
@keyframes g73Wave{
  0%,100%{ transform: scaleY(0.4); }
  50%    { transform: scaleY(1.0); }
}

.g73-play{
  border:1px solid var(--ctl-list-border, rgba(255,255,255,.12));
  background:transparent; color:inherit;
  border-radius:12px; padding:6px 8px; margin-left:8px;
  display:grid; place-items:center; cursor:pointer; flex:0 0 auto;
  transition: transform .12s ease, box-shadow .12s ease, border-color .12s ease;
}
.g73-play .material-icons{
  font-size:20px; line-height:1;
  background-image: var(--ctl-list-fill, var(--prog-fill, linear-gradient(90deg,#5fa0ff,#b478ff)));
  -webkit-background-clip:text; background-clip:text;
  -webkit-text-fill-color:transparent; color:transparent;
  display:block; width:20px; height:20px;
}
.g73-play:hover{
  --_ring: color-mix(in srgb, var(--ctl-list-accent1, #5fa0ff) 45%, transparent);
  transform: translateY(-1px);
  border-color: color-mix(in srgb, var(--_ring) 60%, var(--ctl-list-border, rgba(255,255,255,.12)));
  box-shadow: 0 6px 16px rgba(0,0,0,.30);
}

/* Selected row */
.music-list ul.g73-adapted > li.active,
.music-list ul.g73-adapted > li.playing{
  --_accent1: var(--ctl-list-accent1, #5fa0ff);
  --_accent2: var(--ctl-list-accent2, #b478ff);
  border-color: color-mix(in srgb, var(--_accent1) 68%, var(--ctl-list-border, rgba(255,255,255,.12)));
  box-shadow:
    inset 0 0 0 1px color-mix(in srgb, var(--_accent1) 50%, #000 0%),
    0 0 0 3px color-mix(in srgb, var(--_accent1) 22%, transparent),
    0 10px 24px rgba(0,0,0,.45);
  background:
    linear-gradient(180deg,
      color-mix(in srgb, var(--ctl-list-bg, rgba(13,17,23,.72)) 90%, transparent),
      color-mix(in srgb, var(--ctl-list-bg, rgba(13,17,23,.72)) 72%, transparent));
}
.music-list ul.g73-adapted > li.active::after,
.music-list ul.g73-adapted > li.playing::after{
  content:"";
  position:absolute; inset:-10px; border-radius:18px; pointer-events:none;
  background:
    radial-gradient(70% 120% at 50% 0%,
      color-mix(in srgb, var(--ctl-list-accent1, #5fa0ff) 36%, transparent) 0%,
      color-mix(in srgb, var(--ctl-list-accent2, #b478ff) 24%, transparent) 42%,
      transparent 70%);
  filter: blur(18px); opacity:.95;
  z-index: 0;
}
.music-list ul.g73-adapted > li.active > *,
.music-list ul.g73-adapted > li.playing > *{ position: relative; z-index: 2; }

/* ---------- Row progress (INLINE, always measurable) ---------- */
.g73-row-progress{
  position: relative;           /* in-flow inside .g73-meta */
  height: 6px;
  border-radius: 999px;
  background: color-mix(in srgb, var(--ctl-list-accent2, #b478ff) 20%, transparent);
  margin-top: 6px;
  overflow: hidden;
  outline: 1px solid color-mix(in srgb, var(--ctl-list-border, rgba(255,255,255,.12)) 35%, transparent);
  cursor: pointer;
  pointer-events: auto;
}
.g73-row-bar{
  width: 0%;
  height: 100%;
  background: var(--ctl-list-fill, var(--prog-fill, linear-gradient(90deg,#5fa0ff,#b478ff)));
  box-shadow: 0 0 12px color-mix(in srgb, var(--ctl-list-accent1, #5fa0ff) 36%, transparent);
  transition: width .12s linear;
}

/* Ensure play button always clickable */
.music-list .g73-play-toggle{
  position: relative;
  z-index: 2;
  pointer-events: auto;
  border: 0;
  background: transparent;
  cursor: pointer;
  display: inline-grid;
  place-items: center;
  width: 36px;
  height: 36px;
  border-radius: 10px;
  transition: transform .12s ease, box-shadow .12s ease, background .12s ease;
}
.music-list .g73-play-toggle:hover{
  transform: translateY(-1px);
  background: color-mix(in srgb, var(--ctl-list-accent1, #5fa0ff) 12%, transparent);
  box-shadow: 0 6px 14px rgba(0,0,0,.35);
}

/* Visualizer state helpers (paired with JS classes) */
.music-list li.pre-playing .playing-visualizer,
.music-list li.is-playing .playing-visualizer { opacity: 1; animation-play-state: running; }
.music-list li.is-paused  .playing-visualizer { opacity: .95; animation-play-state: paused; }

/* Timestamp container that preserves the visualizer node */
.audio-duration{ display:inline-flex; align-items:center; gap:6px; min-width:70px; }
.audio-duration .g73-time{ display:inline-block; }
/* Timestamp container stacked vertically */
.audio-duration{
  display: flex;
  flex-direction: column;   /* stack up/down */
  align-items: flex-end;    /* right align */
  justify-content: center;
  gap: 2px;
  min-width: 58px;
  font-size: 12px;
  line-height: 1.2;
  color: color-mix(in srgb, var(--ctl-list-text, #e8eef7) 78%, #000 0%);
}

/* Elapsed time (counting up) */
.audio-duration .g73-time-current{
  font-weight: 600;
  opacity: .95;
}

/* Total time beneath */
.audio-duration .g73-time-total{
  font-size: 11px;
  opacity: .75;
}